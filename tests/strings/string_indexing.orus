// Direct string indexing regression tests exercising VM opcode support
print("== String indexing regression ==")

base = "Hello runtime!"
if assert_eq("base[0]", base[0], "H"):
    print("ok", "base[0]")
if assert_eq("base[6]", base[6], "r"):
    print("ok", "base[6]")
if assert_eq("base[12]", base[12], "e"):
    print("ok", "base[12]")
if assert_eq("base[13]", base[13], "!"):
    print("ok", "base[13]")

rope = ("rope" + "-") + ("engine" + "ering")
if assert_eq("rope[0]", rope[0], "r"):
    print("ok", "rope[0]")
if assert_eq("rope[4]", rope[4], "-"):
    print("ok", "rope[4]")
if assert_eq("rope[9]", rope[9], "n"):
    print("ok", "rope[9]")

try:
    value = base[-1]
    print("FAIL", "negative", value)
catch err:
    print("ok error", "negative")
    print(err)

try:
    value = base[99]
    print("FAIL", "too large", value)
catch err:
    print("ok error", "too large")
    print(err)
print("== done ==")
